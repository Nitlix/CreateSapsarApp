const { genChars } = require('./Random.js')

const streams = {

}

function addStream(data){
    let name = genChars(12) + '.js'
    while (streams[name]){
        name = genChars(12) + '.js'
    }
    
    streams[name] = data
    setTimeout(() => {
        try{delete streams[name]}catch(e){}
    }, 1000 * 60 * 1)

    return name;
}


function getStream(name){
    return (streams[name] || null)    
}

function serveStream(name){
    const streamData = getStream(name)
    if (streamData){
        delete streams[name]
        return streamData
    }
    else {
        return '//unknown stream'
    }
}


module.exports = {
    addStream,
    getStream,
    serveStream
}