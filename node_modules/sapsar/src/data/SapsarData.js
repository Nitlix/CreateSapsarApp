const fs = require('fs')
const path = require('path')

const cacheFormat = {
    css: {
        '*': ''
    },
    js: {
        '*': ''
    },

    pageCompilers: {

    },
    head: {
        '*': ' '
    },
    
    touch: {

    },

    reports: {
        css: {},
        js: {}
    },

    static: {
        pages: {},
        useQueries: [],
        requests: []
    },

    util: {
        404: null
    }
}


const building = {
    status: true
}

const SAPSAR_CACHE_LOCATION = '../../../../sapsar.json'

let cache = JSON.parse(JSON.stringify(cacheFormat))


function clearCacheData(){
    cache = JSON.parse(JSON.stringify(cacheFormat))
}

async function setCache(){
    cache = JSON.parse(
        JSON.stringify(
            (await fs.readFileSync(
                path.join(__dirname, SAPSAR_CACHE_LOCATION)
            )).toString()
        )
    )
    console.log(cache)
}


async function exportCache(){
    await fs.writeFileSync(path.join(__dirname, SAPSAR_CACHE_LOCATION), JSON.stringify(cache))
}


module.exports = {
    cache,
    building,
    clearCacheData,
    setCache,
    exportCache
}

