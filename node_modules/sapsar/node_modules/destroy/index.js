/*!
 * destroy
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2015-2022 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";var EventEmitter=require("events").EventEmitter,ReadStream=require("fs").ReadStream,Stream=require("stream"),Zlib=require("zlib");function destroy(stream,suppress){return isFsReadStream(stream)?destroyReadStream(stream):isZlibStream(stream)?destroyZlibStream(stream):hasDestroy(stream)&&stream.destroy(),isEventEmitter(stream)&&suppress&&(stream.removeAllListeners("error"),stream.addListener("error",noop)),stream}function destroyReadStream(stream){stream.destroy(),"function"==typeof stream.close&&stream.on("open",onOpenClose)}function closeZlibStream(stream){if(!0===stream._hadError){var prop=null===stream._binding?"_binding":"_handle";stream[prop]={close:function(){this[prop]=null}}}stream.close()}function destroyZlibStream(stream){"function"==typeof stream.destroy?stream._binding?(stream.destroy(),stream._processing?(stream._needDrain=!0,stream.once("drain",onDrainClearBinding)):stream._binding.clear()):stream._destroy&&stream._destroy!==Stream.Transform.prototype._destroy?stream.destroy():stream._destroy&&"function"==typeof stream.close?(stream.destroyed=!0,stream.close()):stream.destroy():"function"==typeof stream.close&&closeZlibStream(stream)}function hasDestroy(stream){return stream instanceof Stream&&"function"==typeof stream.destroy}function isEventEmitter(val){return val instanceof EventEmitter}function isFsReadStream(stream){return stream instanceof ReadStream}function isZlibStream(stream){return stream instanceof Zlib.Gzip||stream instanceof Zlib.Gunzip||stream instanceof Zlib.Deflate||stream instanceof Zlib.DeflateRaw||stream instanceof Zlib.Inflate||stream instanceof Zlib.InflateRaw||stream instanceof Zlib.Unzip}function noop(){}function onDrainClearBinding(){this._binding.clear()}function onOpenClose(){"number"==typeof this.fd&&this.close()}module.exports=destroy;