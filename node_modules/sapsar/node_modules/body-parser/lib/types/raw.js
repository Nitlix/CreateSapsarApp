/*!
 * body-parser
 * Copyright(c) 2014-2015 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";var bytes=require("bytes"),debug=require("debug")("body-parser:raw"),read=require("../read"),typeis=require("type-is");function raw(options){var opts=options||{},inflate=!1!==opts.inflate,limit="number"!=typeof opts.limit?bytes.parse(opts.limit||"100kb"):opts.limit,type=opts.type||"application/octet-stream",verify=opts.verify||!1;if(!1!==verify&&"function"!=typeof verify)throw new TypeError("option verify must be function");var shouldParse="function"!=typeof type?typeChecker(type):type;function parse(buf){return buf}return function(req,res,next){return req._body?(debug("body already parsed"),void next()):(req.body=req.body||{},typeis.hasBody(req)?(debug("content-type %j",req.headers["content-type"]),shouldParse(req)?void read(req,res,next,parse,debug,{encoding:null,inflate:inflate,limit:limit,verify:verify}):(debug("skip parsing"),void next())):(debug("skip empty body"),void next()))}}function typeChecker(type){return function(req){return Boolean(typeis(req,type))}}module.exports=raw;