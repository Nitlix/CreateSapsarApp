/*!
 * forwarded
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";function forwarded(req){if(!req)throw new TypeError("argument req is required");var proxyAddrs=parse(req.headers["x-forwarded-for"]||"");return[getSocketAddr(req)].concat(proxyAddrs)}function getSocketAddr(req){return req.socket?req.socket.remoteAddress:req.connection.remoteAddress}function parse(header){for(var end=header.length,list=[],start=header.length,i=header.length-1;i>=0;i--)switch(header.charCodeAt(i)){case 32:start===end&&(start=end=i);break;case 44:start!==end&&list.push(header.substring(start,end)),start=end=i;break;default:start=i}return start!==end&&list.push(header.substring(start,end)),list}module.exports=forwarded;